# 📚 SNI(Server Name Indication)

## 📌 개념

- 컴퓨터 네트워크 전송 계층 보안(TLS) 기반의 웹상에서 클라이언트가 웹 서버에 접속을 시작할 때 접속할 호스트명 정보를 같이 보내는 기능.
- 한 컴퓨터(한 개의 IP와 포트)에서 다수의 가상 웹 서버를 운용할 수 있도록 국제 인터넷 표준화 기구인 IETF에서 만든 TLS 확장 표준
- 실제 홈페이지(IP주소)는 하나지만 여러 주소(URL)로 접속할 수 있도록 홈페이지를 구성하도록 도와준다.
- SNI은 TLS 핸드셰이킹 과정 초기에 클라이언트가 접속할 호스트 정보를 서버에 알려준다. 따라서 동일한 IP 주소로 여러 HTTPS 웹사이트 또는 TLS 상에서 돌아가는 다른 웹서비스를 운영할 수 있다.
- 장점) 각 웹서비스별로 인증서를 발급받아 사용할 수 있어 통합 인증서 문제가 해결될 수 있다.
- 단점) 클라이언트와 서버 간의 보안 접속이 설정되기 전(초기 핸드셰이킹 과정)에 암호화되지 않은 호스트명 정보가 전달되어 사용자가 어느 사이트에 접속을 요청하는지 감청될 수 있다는 문제점이 있다.
- SNI를 사용하기 위해서는 서버뿐만 아니라 클라이언트인 브라우저에서도 SNI 기능을 지원해야한다. (대부분의 브라우저가 SNI 기능을 지원하고 있다.)

## 📌 출현배경

- 기존 TLS 표준을 사용하는 HTTPS 웹 서버에서는, 하나의 IP주소와 고정된 443 포트로 두 개 이상의 서버를 공유하기 어렵다.
- IP 주소 하나에 인증서가 통합 발급되어 인증서 내 호스트명 같은 세부 정보를 수정하는 경우 다시 인증서를 재발급 받아야 한다.
  - 예시) https://10.11.12.13 주소에서 이름의 다른 두 개의 웹사이트 https://doreen1.com 과 https://doreen2.com 을 운영할 수 없다. 또한 각 웹사이트가 아닌 https://10.11.12.13 주소 하나에 인증서가 발급된다.
- 위의 문제를 해결하기 위해 TLS 표준에 확장 기능으로 SNI을 추가하였다.

# 📚 SNI 필드 차단

## 📌 출현 배경

- 기존 불법 유해 사이트 차단 방식이었던 DNS 차단 방식은 우회가 쉬워 불법 유해 사이트를 기술로 차단하기 어려웠다.
- DNS 방식은 사용자가 불법 사이트에 접속하려 할 때 ISP\*가 그 사이트의 원래 IP주소가 아닌 경고문이 적힌 다른 사이트 IP 주소를 알려주는 방식이다.
- 그러나 이 방식은 해외 DNS를 이용하는 등의 우회 방식으로 바뀐 IP 주소가 아닌 원래 주소를 쉽게 찾아낼 수 있다.

(ISP: 개인이나 기업에게 인터넷 접속 서비스, 웹 사이트 구축 등을 제공하는 회사를 말한다. 예시로는 KT, SK브로드밴드 등이 있다.)

## 📌 개념

- SNI를 사용하게 되면 웹 서버 하나에서 여러 도메인 웹사이트를 서비스하는 경우에도 인증서를 사용한 HTTPS를 활성화할 수 있다. 따라서 SNI 차단 방식을 사용하면 HTTPS를 이용한 접속까지 차단할 수 있다.
- SNI 차단 방식도 운영자가 주소를 정기적으로 바꾸거나 가상사설망(VPN)을 사용하면 우회가 가능하다는 한계점이 있다.

SNI 필드 차단은 네트워크 상에 위치한 차단시스템이 인터넷 이용자들의 보안접속(HTTPS)을 이용한 통신 과정을 엿보는 것에서부터 시작된다.

1. HTTPS 통신에서 클라이언트는 환경설정을 위해 접속하고자 하는 웹사이트 서버에 SNI 필드가 포함된 데이터를 보낸다.
2. 이를 받은 서버는 응답 메세지를 전송한다. 클라이언트는 서버로부터 받은 메세지에 들어있는 서버인증서를 검증하는 방식을 통해 암호키를 생성하고 HTTPS 통신을 시작한다.

SNI 차단 기술은 HTTPS 접속 과정에서 클라이언트와 웹서버가 통신 환경 설정을 할 때, SNI 필드에 사용자가 접속하고자 하는 웹사이트의 주소가 암호화되지 않는다는 허점을 노렸다.

차단 장비가 비암호화된 웹사이트 주소 부분을 블랙리스트와 비교하고, 목록에 해당할 경우 웹사이트 접속을 차단하는 것이다.

## 📌 문제점

- SNI 차단 방식은 인터넷 사용자들의 승낙 없이 암호화되지 않은 웹사이트 주소를 차단시스템이 엿본다는 문제가 있다.

## 💌 참고

- https://terms.naver.com/entry.naver?docId=5911988&cid=42346&categoryId=42346

- https://terms.naver.com/entry.naver?docId=6211852&cid=59277&categoryId=67996

- https://terms.naver.com/entry.naver?docId=5756863&cid=43667&categoryId=43667

- https://www.koit.co.kr/news/articleView.html?idxno=77947
